<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Ian Lawson &lt;ilawson@redhat.com&gt;">
<title>OpenShift 4.x DevEx Advanced Workshop</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>OpenShift 4.x DevEx Advanced Workshop</h1>
<div class="details">
<span id="author" class="author">Ian Lawson</span><br>
<span id="email" class="email"><a href="mailto:ilawson@redhat.com">ilawson@redhat.com</a></span><br>
<span id="revnumber">version 1.0.0,</span>
<span id="revdate">February 18, 2020</span>
<br><span id="revremark">Draft</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#intro">Introduction</a>
<ul class="sectlevel2">
<li><a href="#attendee-details">Attendee details</a>
<ul class="sectlevel3">
<li><a href="#what-is-openshift">What is Openshift</a></li>
<li><a href="#links">Links</a></li>
<li><a href="#contributors">Contributors</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#openshift-do">OpenShift DO</a>
<ul class="sectlevel2">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installing">Installing</a></li>
<li><a href="#odo-command-set">odo command set</a></li>
<li><a href="#logging-in">Logging in</a>
<ul class="sectlevel3">
<li><a href="#download-source-assets">Download source assets</a></li>
</ul>
</li>
<li><a href="#create-push-source-run-cycle">Create, push source &amp; run cycle</a></li>
<li><a href="#odo-watch">odo watch</a></li>
</ul>
</li>
<li><a href="#openshift-pipelines-tekton">OpenShift Pipelines - Tekton</a>
<ul class="sectlevel2">
<li><a href="#introduction-2">Introduction</a></li>
<li><a href="#create-a-project">Create a project</a></li>
<li><a href="#tasks">Tasks</a>
<ul class="sectlevel3">
<li><a href="#download-pipeline-assets">Download pipeline assets</a></li>
<li><a href="#simple-task-creation-and-execution">Simple task creation and execution</a></li>
</ul>
</li>
<li><a href="#pipelines">Pipelines</a></li>
<li><a href="#viewing-pipelines-through-the-web-ui">Viewing pipelines through the Web UI</a></li>
<li><a href="#task-inputs">Task inputs</a>
<ul class="sectlevel3">
<li><a href="#task-input-example">Task input example</a></li>
</ul>
</li>
<li><a href="#workspaces-and-volumes">Workspaces and Volumes</a></li>
</ul>
</li>
<li><a href="#camel-k-on-openshift">Camel K on Openshift</a>
<ul class="sectlevel2">
<li><a href="#introduction-3">Introduction</a></li>
<li><a href="#create-a-new-project">Create a new project</a></li>
<li><a href="#camel-k-and-the-operator-lifecycle-manager">Camel K and the Operator Lifecycle Manager</a></li>
<li><a href="#download-and-configure-your-environment">Download and configure your environment</a></li>
<li><a href="#deploy-a-camel-k-interation">Deploy a Camel K Interation</a></li>
<li><a href="#deploy-camel-k-in-developer-mode">Deploy Camel K in Developer mode</a></li>
<li><a href="#optional-labs">Optional labs</a></li>
</ul>
</li>
<li><a href="#camel-k-and-openshift-serverless">Camel K and Openshift Serverless</a>
<ul class="sectlevel2">
<li><a href="#introduction-4">Introduction</a></li>
<li><a href="#create-a-new-project-2">Create a new project</a></li>
<li><a href="#openshift-serverless-and-the-operator-lifecycle-manager">Openshift Serverless and the Operator Lifecycle Manager</a></li>
<li><a href="#install-openshift-serverless">Install Openshift Serverless</a></li>
<li><a href="#download-and-configure-your-environment-2">Download and configure your environment</a></li>
<li><a href="#create-knative-messaging-channel">Create Knative Messaging Channel</a></li>
<li><a href="#deploy-the-integrations">Deploy the Integrations</a></li>
<li><a href="#knative-in-action">Knative in action</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="intro"><a class="anchor" href="#intro"></a>Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="attendee-details"><a class="anchor" href="#attendee-details"></a>Attendee details</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-bottom"><div class="content"><div class="paragraph">
<p>Name:</p>
</div></div></td>
<td class="tableblock halign-left valign-bottom"><div class="content"></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-bottom"><div class="content"><div class="paragraph">
<p>User ID (userX):</p>
</div></div></td>
<td class="tableblock halign-left valign-bottom"><div class="content"></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This workshop is designed to introduce Developers to <strong>OpenShift 4</strong> and explain the usage and technologies around it from a developer perspective.</p>
</div>
<div class="sect3">
<h4 id="what-is-openshift"><a class="anchor" href="#what-is-openshift"></a>What is Openshift</h4>
<div class="paragraph">
<p>Red Hat® OpenShift® is a hybrid cloud, enterprise, secure Kubernetes application platform.</p>
</div>
<div class="paragraph">
<p>OpenShift is an Enterprise strength, secure implementation of the Kubernetes container orchestration project with additional tooling designed to make the lives of Developer and Administrators as easy as possible.</p>
</div>
</div>
<div class="sect3">
<h4 id="links"><a class="anchor" href="#links"></a>Links</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.openshift.com/learn/what-is-openshift">https://www.openshift.com/learn/what-is-openshift</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/OpenShift">https://en.wikipedia.org/wiki/OpenShift</a></p>
</li>
<li>
<p><a href="https://www.openshift.com/products/container-platform">https://www.openshift.com/products/container-platform</a></p>
</li>
<li>
<p><a href="https://console-openshift-console.apps.cluster-landg-2a04.landg-2a04.example.opentlc.com/" class="bare">https://console-openshift-console.apps.cluster-landg-2a04.landg-2a04.example.opentlc.com/</a> (the Web Console URL for the Workshop)</p>
</li>
<li>
<p><a href="https://terminal-terminal.apps.cluster-landg-2a04.landg-2a04.example.opentlc.com/" class="bare">https://terminal-terminal.apps.cluster-landg-2a04.landg-2a04.example.opentlc.com/</a> (The Web Terminal URL for the workshop)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="contributors"><a class="anchor" href="#contributors"></a>Contributors</h4>
<div class="paragraph">
<p>Red Hat UK DSA Team:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Phil Prosser</p>
</li>
<li>
<p>Mark Roberts</p>
</li>
<li>
<p>''Uther'' Lawson</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Original asciidoc project for DevEx3.x by Phillip Kruger, Red Hat CEMEA</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openshift-do"><a class="anchor" href="#openshift-do"></a>OpenShift DO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h3>
<div class="paragraph">
<p><strong>The OpenShift command line interface 'oc' is a general purpose interface with a vast set of commands for both development and administrative purposes. The odo command is a more developer centric command line interface for users who simply want to build, deploy and run applications on OpenShift. There is definitely a place for both tools within the kitbag of an OpenShift user, and for fast iterations of edit - run - edit - run the odo interface is perfect.</strong></p>
</div>
<div class="paragraph">
<p><strong>The approach described in the application basics chapter used a GIT repository as the source of the content to be built and deployed. This is a excellent approach when multiple users are working together in a complex application performing frequent integration of source code in GIT and validating their combined efforts as the project progresses. Avoiding such frequent integration activity will make the code of each developer diverge storing up integration headaches in the future.</strong></p>
</div>
<div class="paragraph">
<p><strong>The ability of the OpenShift 'Source-2-image' capability to identify the code within the GIT repository (from the options of Node.js, Java, Ruby, Perl, PHP, and Python), select a builder image, build the code and deliver a new container with the running application is a huge efficiency advantage for teams. However there are scenarios in which a single developer simply wants to get their code running as quickly as possible and which is where odo can be advantageous.</strong></p>
</div>
<div class="paragraph">
<p><strong>The principle of the odo command is that it can very quickly create a new project and use a 'GIT like' syntax to enable a developer to push the code into OpenShift. The receiving OpenShift cluster will then decide how to build the code, perform the build and deliver a running container. When the developer wants to make changes they simply push their code and the build and deploy operations are repeated. The first push process may take around a minute, but after that each iteration will take only a few seconds.</strong></p>
</div>
<div class="paragraph">
<p><strong>The diagram below shows how the odo command can fit into a development cycle. The outline diagram shows that the odo command is appropriate for single developers working with a degree of isolation, the team development involves multiple developers integrating their code through a GIT repository and the final phase involves the use of multiple clusters for the deployment of applications through to production.</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/odo-1.png" alt="odo in the development cycle">
</div>
</div>
<div class="paragraph">
<p><strong>In more detail the diagram below shows how odo and oc / source-2-image work together to create a scaled development experience. In the single user phase the odo command is used to push the application code to a container in OpenShift. In the light blue box the source code is pushed to OpenShift in which the language specific builder image is used to create a new image containing the built code. This  image is started to create a running container. When the developer needs to share the code with the work of others GIT is used as a vehicle for integration and to remove any code conflicts.  This is the medium blue box in which the code is pushed to GIT and the OpenShift source-2-image capability is used to build a new running container. In the final phase shown in the darker blue box, the built container image can then be pushed to the Quay image repository to be stored securely ready for deployment to further environments such as pre-production and production.</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/odo-2.png" alt="odo in the development cycle - detail">
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing"><a class="anchor" href="#installing"></a>Installing</h3>
<div class="paragraph">
<p>The odo command line interface is available for download from here : <a href="https://github.com/openshift/odo" class="bare">https://github.com/openshift/odo</a></p>
</div>
<div class="paragraph">
<p><strong>The Applications Basics chapter describes two different mechanisms for getting access to the command line tools for this workshop. If you are using the terminal within a container (option 2) then you already have the odo command line available to you. If you have chosen to install the command line utilities locally on your laptop then you will need to install odo using the download location above.</strong></p>
</div>
<div class="paragraph">
<p><strong>To use the command simply type 'odo' and you will see help regarding the objects and to get help on a specific object use 'odo &lt;object&gt; --help'.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="odo-command-set"><a class="anchor" href="#odo-command-set"></a>odo command set</h3>
<div class="paragraph">
<p><strong>The odo command has the following subcommands :</strong></p>
</div>
<div class="paragraph">
<p>Commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app         Perform application operations (delete, describe, list)
catalog     Catalog related operations (describe, list, search)
component   Manage components (create, delete, describe, link, list, log, push, unlink, update, watch)
config      Change or view configuration (set, unset, view)
debug       Debug commands (port-forward)
preference  Modifies preference settings (set, unset, view)
project     Perform project operations (create, delete, get, list, set)
service     Perform service catalog operations (create, delete, list)
storage     Perform storage operations (create, delete, list)
url         Expose component to the outside world (create, delete, list)</pre>
</div>
</div>
<div class="paragraph">
<p>Utility Commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login       Login to cluster
logout      Log out of the current OpenShift session
utils       Utilities for terminal commands and modifying odo configurations (terminal)
version     Print the client version information</pre>
</div>
</div>
<div class="paragraph">
<p>Component Shortcuts:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>create      Create a new component
delete      Delete component
describe    Describe component
link        Link component to a service or component
list        List all components in the current application
log         Retrieve the log for the given component
push        Push source code to a component
unlink      Unlink component to a service or component
update      Update the source code path of a component
watch       Watch for changes, update component on change</pre>
</div>
</div>
<div class="paragraph">
<p><strong>The most common are used within this workshop but feel free to experiment with any of the above commands.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="logging-in"><a class="anchor" href="#logging-in"></a>Logging in</h3>
<div class="paragraph">
<p><strong>To login using odo enter the command :</strong></p>
</div>
<div class="paragraph">
<p>odo login &lt;user-name&gt;</p>
</div>
<div class="paragraph">
<p><strong>If you are already logged in with the oc command then the credentials will be cached (assuming you use the same user name) and you will not have to enter a password.</strong></p>
</div>
<div class="paragraph">
<p><strong>The odo command will evolve over time and it performs a check to see if you have the latest version each time it is used. If there is an update available you will see a prompt similar to that which is shown below, underneath the text reporting the project that you are using.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">---
A newer version of odo (v1.0.2) is available,
visit https://github.com/openshift/odo/releases to update.
If you wish to disable this notification, run:
odo preference set UpdateNotification false
---</code></pre>
</div>
</div>
<div class="paragraph">
<p>*To see which version of odo you are using enter the command : *</p>
</div>
<div class="paragraph">
<p>odo version</p>
</div>
<div class="sect3">
<h4 id="download-source-assets"><a class="anchor" href="#download-source-assets"></a>Download source assets</h4>
<div class="paragraph">
<p><strong>The pipeline assets are located in a GIT repository. Using your terminal window download the assets using the command below (if you have not done so for a previous chapter).</strong></p>
</div>
<div class="paragraph">
<p>If you are using the terminal in a pod ensure that the current directory is /workspace. If you are using your local machine select an appropriate location to which you have write access.</p>
</div>
<div class="paragraph">
<p>git clone <a href="https://github.com/utherp0/workshop4.git" class="bare">https://github.com/utherp0/workshop4.git</a></p>
</div>
<div class="paragraph">
<p>cd workshop4/attendee/slave</p>
</div>
<div class="paragraph">
<p>ls -al</p>
</div>
<div class="paragraph">
<p><strong>You will see that the directory only has the source file slave.js and the package file called package.json.</strong></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-push-source-run-cycle"><a class="anchor" href="#create-push-source-run-cycle"></a>Create, push source &amp; run cycle</h3>
<div class="paragraph">
<p><strong>Create a new project using the odo command replacing X with your user number below.</strong></p>
</div>
<div class="paragraph">
<p>odo create nodejs node-app-slave --project master-slave-odo</p>
</div>
<div class="paragraph">
<p><strong>The syntax of the above command is :</strong></p>
</div>
<div class="paragraph">
<p><strong>odo create &lt;component-type&gt; &lt;component-name&gt; --project &lt;project-for-the-component&gt;</strong></p>
</div>
<div class="paragraph">
<p><strong>The result of running this command is simply the creation of a .odo directory containing a config.yaml file. The file contains the desired state for the application in OpenShift and is only committed to OpenShift and acted upon by OpenShift when the user issues the command 'odo push'. Examine the config.yaml file with the command:</strong></p>
</div>
<div class="paragraph">
<p>cat .odo/config.yaml</p>
</div>
<div class="paragraph">
<p><strong>Create a route for the application by using the command below:</strong></p>
</div>
<div class="paragraph">
<p>odo url create node-app-slave</p>
</div>
<div class="paragraph">
<p><strong>Examine the contents of the .odo/config.yaml file again and you will see that new content has been added:</strong></p>
</div>
<div class="paragraph">
<p>cat .odo/config.yaml</p>
</div>
<div class="paragraph">
<p><strong>Push the configuration to OpenShift:</strong></p>
</div>
<div class="paragraph">
<p>odo push</p>
</div>
<div class="paragraph">
<p><strong>The output from the above command is shown below:</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/odo-3.png" alt="odo in the development cycle - detail">
</div>
</div>
<div class="paragraph">
<p><strong>The application is started up and will be running at the URL indicated in the output above. Copy the URL from your command window and paste it into a new browser tab. You should see an output similar to that shown below.</strong></p>
</div>
<div class="paragraph">
<p>Hello - this is the simple slave REST interface v1.0</p>
</div>
<div class="paragraph">
<p><strong>Make a small change to the comment in the source code of the slave.js file to change the line shown below:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">response.send('Hello - this is the simple slave REST interface' + versionIdentifier);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Change to :</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">response.send('Hello - MODIFIED and pushed with ODO' + versionIdentifier);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Push the change to OpenShift:</strong></p>
</div>
<div class="paragraph">
<p>odo push</p>
</div>
<div class="paragraph">
<p><strong>The code still needed to be pushed to the component, but the final stage of building the component is much faster. Refresh the browser widow showing the application output and you will see your code change. The edit - push - test cycle is as simple as that.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="odo-watch"><a class="anchor" href="#odo-watch"></a>odo watch</h3>
<div class="paragraph">
<p><strong>The odo process also has a 'watch' facility that allows you to force odo to constantly watch for source code changes and push them immediately. If you are using the terminal in a container open a second window so that you have two terminal windows. If you are using your local laptop simply open another terminal window. Ensure that the new terminal window is in the same directory as the first terminal window. Enter the command below to make odo watch for source code changes:</strong></p>
</div>
<div class="paragraph">
<p>odo watch</p>
</div>
<div class="paragraph">
<p><strong>The command window should report : 'Waiting for something to change in &lt;current-working-directory&gt;'</strong></p>
</div>
<div class="paragraph">
<p><strong>Switch back to your other terminal window and make another change to the source code, similar to the change above. After saving the edit switch to the terminal window in which you typed 'odo watch' and observe that a new push of the code to OpenShift has taken place.</strong></p>
</div>
<div class="paragraph">
<p><strong>The window with the watch command running will report:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">File &lt;path-to-source&gt;/slave.js changed
Pushing files...
 ✓  Waiting for component to start [73ms]
 ✓  Syncing files to the component [11s]
 ✓  Building component [4s]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Refresh the browser widow showing the application output and you will see your code change.</strong></p>
</div>
<div class="paragraph">
<p><strong>odo is clearly a very fast way to go from code to running your application without having to install tools and frameworks on your laptop.</strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openshift-pipelines-tekton"><a class="anchor" href="#openshift-pipelines-tekton"></a>OpenShift Pipelines - Tekton</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction-2"><a class="anchor" href="#introduction-2"></a>Introduction</h3>
<div class="paragraph">
<p><strong>For many years teams have created automation pipelines to build, unit test, analyse and deploy applications in a variety of tool-chains. Some such tool-chains (Jenkins for one) pre-date the popularisation of containers and are now being questioned for their fit for the delivery of cloud native applications. While we are at pains not to criticise Jenkins (we are big users and fans) there is scope to look at alternative approaches for cloud native applications.</strong></p>
</div>
<div class="paragraph">
<p><strong>OpenShift Pipelines are based on the Tekton open source project and they provide a Kubernetes style, resource based approach to the construction of pipelines. Tasks are defined as small units of operations (typically 10 to 15 lines of YAML) and such tasks are grouped together into taskruns or pipelines for execution</strong>.</p>
</div>
<div class="paragraph">
<p><strong>A new command line exists for the execution of Tekton commands and a graphical user interface can be added to the cluster to provide a simple way to run tasks and to observe running or completed tasks.</strong></p>
</div>
<div class="paragraph">
<p>The Tekton project can be found here : <a href="https://tekton.dev/" class="bare">https://tekton.dev/</a></p>
</div>
<div class="paragraph">
<p>Further documentation on the specifics of Tekton can be found on the github site here : <a href="https://github.com/tektoncd/pipeline" class="bare">https://github.com/tektoncd/pipeline</a></p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-project"><a class="anchor" href="#create-a-project"></a>Create a project</h3>
<div class="paragraph">
<p><strong>Create a project to use for the OpenShift pipeline examples called pipelines-userX replacing X with your user number in the following command:</strong></p>
</div>
<div class="paragraph">
<p>oc new-project pipelines-userX</p>
</div>
</div>
<div class="sect2">
<h3 id="tasks"><a class="anchor" href="#tasks"></a>Tasks</h3>
<div class="sect3">
<h4 id="download-pipeline-assets"><a class="anchor" href="#download-pipeline-assets"></a>Download pipeline assets</h4>
<div class="paragraph">
<p><strong>The pipeline assets are located in a GIT repository. Using your terminal window download the assets using the command below.</strong></p>
</div>
<div class="paragraph">
<p>If you are using the terminal in a pod ensure that the current directory is /workspace. If you are using your local machine select an appropriate location to which you have write access.</p>
</div>
<div class="paragraph">
<p>git clone <a href="https://github.com/utherp0/workshop4.git" class="bare">https://github.com/utherp0/workshop4.git</a></p>
</div>
<div class="paragraph">
<p>cd workshop4/attendee/tekton/</p>
</div>
<div class="paragraph">
<p>ls -al</p>
</div>
<div class="paragraph">
<p>You should now see a list of yaml files that are used during the remainder of this chapter.</p>
</div>
</div>
<div class="sect3">
<h4 id="simple-task-creation-and-execution"><a class="anchor" href="#simple-task-creation-and-execution"></a>Simple task creation and execution</h4>
<div class="paragraph">
<p><strong>In the simplest format a task can be executed by a taskrun object. The digram below shows a simple taskrun calling a single task.</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-1.png" alt="Simple pipeline with a task and taskrun">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Tekton command line</div>
<div class="paragraph">
<p>A new command line utility is used to manage the Tekton command line. The commands cover the various different pipeline objects such as task, taskrun, pipeline, pipelinerun,  resources, cluster tasks and conditions.</p>
</div>
<div class="paragraph">
<p>The Tekton command line is downloaded from here : <a href="https://github.com/tektoncd/cli" class="bare">https://github.com/tektoncd/cli</a></p>
</div>
<div class="paragraph">
<p>If you are using the terminal within a container (option 2) from the installation details in the Application Basics chapter then you already have the tkn command line available to you. If you have chosen to install the command line utilities locally on your laptop then you will need to install tkn using the download location above.</p>
</div>
<div class="paragraph">
<p>To use the command simply type 'tkn' and you will see help regarding the objects and to get help on a specific object use 'tkn &lt;object&gt; --help'.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>To execute the above pipeline use the following commands to create the pipeline objects. Note that when creating the taskrun objects the associated task(s) will run immediately.</strong></p>
</div>
<div class="paragraph">
<p>oc create -f task-1.yaml</p>
</div>
<div class="paragraph">
<p>oc create -f taskrun-1.yaml</p>
</div>
<div class="paragraph">
<p>tkn taskrun ls</p>
</div>
<div class="paragraph">
<p><strong>The response from the last command will display a line similar to the following:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NAME          STARTED           DURATION      STATUS
task-run-1    9 seconds ago     ---           Running(Pending)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Repeat the final command a few times until you see it change to the following:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NAME          STARTED           DURATION      STATUS
task-run-1    3 minuites ago    21 seconds    Succeeded</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>The result of running the task can then be viewed by executing the following command:</strong></p>
</div>
<div class="paragraph">
<p>tkn taskrun logs task-run-1</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[echo-statement-1] This is my first task in Tekton

[echo-statement-2] ------------------------------------------------------------
[echo-statement-2]   - This is a multi-line comment
[echo-statement-2]   - This is useful as a separator but each line has
[echo-statement-2]   - the title repeated next to it using different colours
[echo-statement-2]   - which helps with the identification of different tasks.
[echo-statement-2]  ------------------------------------------------------------
[echo-statement-2]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note that the command response above uses different colours for each block of command result titles in the [ ] brackets. This helps to differential between the response for each step.</strong></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines"><a class="anchor" href="#pipelines"></a>Pipelines</h3>
<div class="paragraph">
<p><strong>Pipelines are used to manage the execution of a series of tasks within a pipeline. The example pipeline below is used to execute the Tekton tasks : task-1, task-2 and task-3. Remember that each Tekton task can have multiple steps within it.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: pipeline-1
spec:
  tasks:
  - name: task-1
    taskRef:
      name: task-1
  - name: task-2
    taskref:
      name: task-2
  - name: task-3
    taskref:
      name: task-3</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Before executing this pipeline create the required additional resources with the commands :</strong></p>
</div>
<div class="paragraph">
<p>oc create -f task-2.yaml</p>
</div>
<div class="paragraph">
<p>oc create -f task-3.yaml</p>
</div>
<div class="paragraph">
<p>oc create -f pipeline-1.yaml</p>
</div>
<div class="paragraph">
<p><strong>Execute the pipeline with the following Tekton task</strong>.</p>
</div>
<div class="paragraph">
<p>tkn pipeline start pipeline-1</p>
</div>
<div class="paragraph">
<p><strong>The output of running this command will be something similar to that which is shown below:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">Pipelinerun started: pipeline-1-run-ffxsk
Showing logs...
[task-2 : what-directory] /workspace

[task-2 : describe-command] ------------------------------------------------------------
[task-2 : describe-command]   - Openshift oc command line example
[task-2 : describe-command]  ------------------------------------------------------------
[task-2 : describe-command]

[task-2 : oc-version] Client Version: unknown
[task-2 : oc-version] Kubernetes Version: v1.14.6+76aeb0c

[task-3 : echo-statement-3] echo - statement 3
[task-1 : echo-statement-1] This is my first task in Tekton


[task-3 : echo-statement-4] echo - statement 4

[task-1 : echo-statement-2] ------------------------------------------------------------
[task-1 : echo-statement-2]   - This is a multi-line comment
[task-1 : echo-statement-2]   - This is useful as a separator but each line has
[task-1 : echo-statement-2]   - the title repeated next to it using different colours
[task-1 : echo-statement-2]   - which helps with the identification of different tasks.
[task-1 : echo-statement-2]  ------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>There may be an issue in the order of the execution above. The order of the pipeline expected is different to the order observed:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">   Expected               Actual
task 1 - step 1       task 2 - step 1
task 1 - step 2       task 2 - step 2
task 2 - step 1       task 2 - step 3
task 2 - step 2       task 3 - step 1
task 2 - step 3       task 1 - step 1
task 3 - step 1       task 3 - step 2
task 3 - step 2       task 1 - step 2</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>In some pipelines the order of execution may not matter but if it does the order can be managed by the addition of the 'runAfter' directive to a specific task as shown in the update to the pipeline-1 pipeline shown below:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: pipeline-1
spec:
  tasks:
  - name: task-1
    taskRef:
      name: task-1
  - name: task-2
    taskref:
      name: task-2
    runAfter:
    - task-1
  - name: task-3
    taskref:
      name: task-3
    runAfter:
    - task-2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make the above changes to the pipeline-1.yaml file and then remove the pipeline definition and recreate it before re-running it with the commands :</p>
</div>
<div class="paragraph">
<p>oc delete -f pipeline-1.yaml</p>
</div>
<div class="paragraph">
<p>oc create -f pipeline-1.yaml</p>
</div>
<div class="paragraph">
<p>tkn pipeline start pipeline-1</p>
</div>
<div class="paragraph">
<p><strong>This time the execution will follow the intended order.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="viewing-pipelines-through-the-web-ui"><a class="anchor" href="#viewing-pipelines-through-the-web-ui"></a>Viewing pipelines through the Web UI</h3>
<div class="paragraph">
<p><strong>Pipelines and pipeline runs are visible through the OpenShift web user interface.</strong></p>
</div>
<div class="paragraph">
<p>Ensure that you are on the 'Developer' view of the OpenShift web user interface as shown below and select the project created above from the drop down list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-2.png" alt="Developer view of OpenShift WEB UI">
</div>
</div>
<div class="paragraph">
<p>Select the pipelines tab on the left hand side of the screen.</p>
</div>
<div class="paragraph">
<p>You will see the pipeline recently created and it will show a green bar to the right indicating the previous successful execution of the pipeline, as shown below. Note that the green bar will display dark blue sections for running tasks, light blue sections for pending tasks, green for completed and red for failed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-3.png" alt="Pipeline view showing a completed pipeline run">
</div>
</div>
<div class="paragraph">
<p>From the three dot menu on the right hand side it is possible to start a run of the pipeline. Do this now and watch as the screen changes to show the details of the pipeline run as shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-4.png" alt="Pipelinerun in progress">
</div>
</div>
<div class="paragraph">
<p>Each block can be clicked on to show the details of the steps within the task. Experiment with the different screens to look at the details of the running or completed tasks.</p>
</div>
</div>
<div class="sect2">
<h3 id="task-inputs"><a class="anchor" href="#task-inputs"></a>Task inputs</h3>
<div class="paragraph">
<p><strong>There will be scenarios where it is necessary to provide specific parameters to a pipeline process and the underlying tasks that the pipeline call.</strong></p>
</div>
<div class="paragraph">
<p><strong>There are two mechanisms for getting specific values into tasks :</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameters - used to provide specific values to tasks at runtime. If a parameter is declared it must either have a default value defined within the task or it must have a value supplied from a calling taskrun or pipeline run.</p>
</li>
<li>
<p>pipeline resources - a reference to a defined resource object that can be accessed by a Tekton pipeline. If a resource is referenced by a task then the resource must exist unless it has been defined as an optional resource in the task definition.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Pipeline Resource Types</div>
<div class="paragraph">
<p>The following pipeline resource types exist :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Git Resource - The git resource identifies a git repository, that contains the source code to be built by the pipeline. The resource can point to a specific branch or commit and can extract content from a specific directory.</p>
</li>
<li>
<p>Pull Request - Can be used as an input resource to identify specific meta data about a pull request. if used as an output a pull request can be updated with changes made during the pipeline process.</p>
</li>
<li>
<p>Image - An image to be created as part of the pipeline process.</p>
</li>
<li>
<p>Cluster Resource - A different cluster to the cluster on which the pipeline is running. This can be used to deploy content to an alternative cluster as part of a deployment pipeline process.</p>
</li>
<li>
<p>Storage Resource - Blob storage that contains either an object or directory.</p>
</li>
<li>
<p>Cloud Event Resource - A cloud event that is sent to a target URI upon completion of a TaskRun.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Further details on the options for all of the above resources is included here : <a href="https://github.com/tektoncd/pipeline/blob/master/docs/resources.md" class="bare">https://github.com/tektoncd/pipeline/blob/master/docs/resources.md</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="task-input-example"><a class="anchor" href="#task-input-example"></a>Task input example</h4>
<div class="paragraph">
<p><strong>The task defined in task-4.yaml uses both parameters and pipeline resources to get information into the task. This allows a generic task to be written with specific values supplied to it from the taskrun. The Taskrun object acts as a 'value provider' giving specific values for parameters and referencing specific pipeline resources. The following diagram shows the relationship between the three specific objects.</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-5.png" alt="Task and resource relationship">
</div>
</div>
<div class="paragraph">
<p><strong>As shown above the task has place-holders for two parameters. The first parameter has a value defined within the taskrun. The second parameter has a default value so it is not essential to provide a value for it in the taskrun. Both parameters are referenced from the steps of the task using the notation $(inputs.params.&lt;parameter-name&gt;).</strong></p>
</div>
<div class="paragraph">
<p><strong>The task also defines a resource object called git-repo-slave of type git. Within the taskrun an input resource object is defined with the same name (git-repo-slave) referring to a pipeline resource object called git-repo-slave-resource. A pipeline resource object is created from the yaml file git-resources.yaml which makes a reference to the actual git repository.</strong></p>
</div>
<div class="paragraph">
<p><strong>To create the resource object execute the following command :</strong></p>
</div>
<div class="paragraph">
<p>oc create -f git-resources.yaml</p>
</div>
<div class="paragraph">
<p><strong>To view the resources in the project use the command:</strong></p>
</div>
<div class="paragraph">
<p>tkn resources list</p>
</div>
<div class="paragraph">
<p><strong>The response will be :</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NAME                      TYPE   DETAILS
git-repo-slave-resource   git    url: https://github.com/marrober/slave-node-app.git</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>The use of pipeline resource objects for git repositories and created images (as output resources) helps teams to create generic build, test and deploy pipelines that can be reused across multiple projects where the projects simply define the custom pipeline resource objects that are specific to their project or environment.</strong></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="workspaces-and-volumes"><a class="anchor" href="#workspaces-and-volumes"></a>Workspaces and Volumes</h3>
<div class="paragraph">
<p><strong>Workspaces allow you to organise the content used by tasks and the assets that are produced by tasks. This can be useful to add structure to the content during large complex pipelines. Workspaces are storage structures within the pod that runs the containers of the pipeline and workspaces are scoped at the task level. Separate steps within a task can see the same workspace. Volumes are similar to workspaces except for the fact that they are backed by persistent volumes. This ensures that content written to the volume is accessible by steps from multiple tasks, allowing for a greater separation of steps into different tasks. For example a generic build task could be used to create an executable, writing the deliverable to a volume. A separate testing task could then be invoked by a pipeline to perform tests against the newly created deliverable. Accessing the file via a volume will work for the two separate tasks.</strong></p>
</div>
<div class="paragraph">
<p><strong>Task 5 has steps for creating files in the workspace and in a volume, followed by steps to display the files in the workspace and the volume which work fine. Task 6 only has tasks for attempting to display the content of the workspace and the volume. Since the workspace in task 6 is a different workspace to that used in task 5 there is no content to display. The volume however shows the file written in the step in task 5. Tasks 5 and 6 are orchestrated by the pipeline called pipeline-5.</strong></p>
</div>
<div class="paragraph">
<p>Create the persistent volume claim to use in this exercise with the command :</p>
</div>
<div class="paragraph">
<p>oc create -f persistentvolumeclaim.yaml</p>
</div>
<div class="paragraph">
<p>Create tasks 5 and 6 :</p>
</div>
<div class="paragraph">
<p>oc create -f task-5.yaml</p>
</div>
<div class="paragraph">
<p>oc create -f task-6.yaml</p>
</div>
<div class="paragraph">
<p>Create the pipeline task :</p>
</div>
<div class="paragraph">
<p>oc create -f pipeline-5.yaml</p>
</div>
<div class="paragraph">
<p><strong>The persistent volume will show that it is in an pending state after creation as no resource has attempted to consume it. After the task has been executed look again at the persistent volume and it will show that it is bound.</strong></p>
</div>
<div class="paragraph">
<p>oc get pvc</p>
</div>
<div class="paragraph">
<p><strong>Before executing the task</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NAME                    STATUS        VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
tekton-task-cache-pvc   Pending                                                                            gp2            4s</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>After executing the task</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">NAME                    STATUS        VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
tekton-task-cache-pvc   Bound         pvc-1d894a93-2646-11ea-9f45-0a9970779e5c   1Gi        RWO            gp2            2m2s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Execute the pipeline :</p>
</div>
<div class="paragraph">
<p>tkn pipeline start pipeline-5</p>
</div>
<div class="paragraph">
<p>The results (including the colour of the output) is shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipelines-6.png" alt="Workspace and volume example output">
</div>
</div>
<div class="paragraph">
<p><strong>As shown above in task 5 the creation of the file in the workspace and in the volume functions as required and the files are present. When task 6 attempts to display the files there is an empty workspace, but the volume does show the file created in task 5</strong></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="camel-k-on-openshift"><a class="anchor" href="#camel-k-on-openshift"></a>Camel K on Openshift</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction-3"><a class="anchor" href="#introduction-3"></a>Introduction</h3>
<div class="paragraph">
<p>Apache Camel K is a lightweight integration framework built from Apache Camel that runs natively on Kubernetes and is specifically designed for serverless and microservice architectures.</p>
</div>
<div class="paragraph">
<p>Users of Camel K can instantly run integration code written in Camel DSL on their preferred cloud (Kubernetes or OpenShift).</p>
</div>
<div class="paragraph">
<p>We are going to use a new project to create our Camel K integrations</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are not already logged on go to the UI URL and login as userx (x is the number provided to you) and password openshift. Open another tab in the browser and go to the terminal URL provided and again logon as userx with password openshift
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="create-a-new-project"><a class="anchor" href="#create-a-new-project"></a>Create a new project</h3>
<div class="paragraph">
<p>In the browser based terminal window, create a new project called 'camelk-userx' where 'x' is your allocated user number</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc new-project camelk-userx</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="camel-k-and-the-operator-lifecycle-manager"><a class="anchor" href="#camel-k-and-the-operator-lifecycle-manager"></a>Camel K and the Operator Lifecycle Manager</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Camel K and the Operator Lifecycle Manager</div>
<div class="paragraph">
<p>Camel K uses the Operator Lifecycle manager, this means that new Custom Resource Definitions (CRDs) will be added to Openshift. These CRDs will extend the Openshift data model and allow Camel K to be managed using the standard ‘oc’ command. Installing operators requires a higher cluster privilage so the presenter will demonstrate the installation of the operator shortly.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Before installing Camel K, make sure that the CRDs do not exist.</p>
</div>
<div class="paragraph">
<p>In the terminal window type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc whoami</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the response from the command is not your user name. Type ‘oc login’ and enter your username (userx) and password ‘openshift’. Rather than using your username and password, you could also use the recommended solution in the web console overview.</p>
</div>
<div class="paragraph">
<p>In the terminal browser window, type:-</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc get integrations
oc get integrationplatforms</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both of these commands should return a <strong>resource type</strong> error</p>
</div>
<div class="paragraph">
<p><strong>'ADMIN only - Presenter demonstrates'</strong></p>
</div>
<div class="paragraph">
<p>Explain both of the above CRDs and what they are used for in Camel K</p>
</div>
<div class="paragraph">
<p>Install Camel K:</p>
</div>
<div class="paragraph">
<p>If you are not already logged on go to the UI URL and login as 'opentlc-mgr' (Don’t forget to explain that this is a cluster admin function) and the admin password</p>
</div>
<div class="paragraph">
<p>Make sure you are on the 'Administration View' in the console</p>
</div>
<div class="paragraph">
<p>Go to 'Operators/Operator Hub'</p>
</div>
<div class="paragraph">
<p>Search for 'camel k'</p>
</div>
<div class="paragraph">
<p>Install for all 'namespaces' in the cluster</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camelk-1.png" alt="Camel K Operator Installation">
</div>
</div>
<div class="paragraph">
<p>Wait until the 'Camel K Operator' is shown as installed on the Operators/Installed Operators window</p>
</div>
<div class="paragraph">
<p><strong>'ADMIN only - finished'</strong></p>
</div>
<div class="paragraph">
<p>In the browser terminal window
Type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc get integrations
oc get integrationplatforms</code></pre>
</div>
</div>
<div class="paragraph">
<p>This time, both commands should return “no resources found”</p>
</div>
<div class="paragraph">
<p>Download the 'Camel K' examples using the browser terminal :-</p>
</div>
</div>
<div class="sect2">
<h3 id="download-and-configure-your-environment"><a class="anchor" href="#download-and-configure-your-environment"></a>Download and configure your environment</h3>
<div class="paragraph">
<p>Create a directory to download the examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">mkdir camel
cd camel</code></pre>
</div>
</div>
<div class="paragraph">
<p>Download the Camel K examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">wget https://github.com/pprosser-redhat/devex-camelk/raw/master/camelexamples/camel-k-examples-1.0.0-M4.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new directory for the examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">mkdir examples</code></pre>
</div>
</div>
<div class="paragraph">
<p>Uncompress the file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">tar -xf camel-k-examples-1.0.0-M4.tar.gz -C examples</code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow a developer to easily interact with an Openshift cluster, Camel K has it&#8217;s own command line interface. Download the 'Camel K cli' :-</p>
</div>
<div class="paragraph">
<p>In the same directory, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">wget https://github.com/pprosser-redhat/devex-camelk/raw/master/camelkcli/camel-k-client-1.0.0-M4-linux-64bit.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Uncompress the file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">tar -xf camel-k-client-1.0.0-M4-linux-64bit.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before we can create an integration, we need to add a Camel K 'IntegrationPlatform'.</p>
</div>
<div class="paragraph">
<p>In the terminal window, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc apply -f   https://raw.githubusercontent.com/pprosser-redhat/devex-camelk/master/camelkconfig/integrationplatform.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>You should now have all the pieces you need to start creating and deploying lightweight Camel Integrations to Openshift.</strong></p>
</div>
<div class="paragraph">
<p>If you type 'ls' on the command line, then you should see a similer list of files to those below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camelk-2.png" alt="Camel K file list">
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy-a-camel-k-interation"><a class="anchor" href="#deploy-a-camel-k-interation"></a>Deploy a Camel K Interation</h3>
<div class="paragraph">
<p>Firstly, let’s start by deploying a simple integration, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel run examples/simple.groovy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The first time you deploy an Integration, it will take a few minutes. The operator manages all dependencies required by the Integration and downloads these from the Red Hat repository on demand. Once downloaded, the operator caches dependancies therefore subsequent deployments are significantly quicker. If you want to see what&#8217;s happen, in the terminal window type 'oc get pods', you will see that there are builds running
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can see what’s going on :-</p>
</div>
<div class="paragraph">
<p>If you go to the console UI in the Browser, make sure you are switched to 'Developer view'</p>
</div>
<div class="paragraph">
<p>Click on 'Topology'</p>
</div>
<div class="paragraph">
<p>Click on 'Simple' (this is your integration), and you can see what’s going on.</p>
</div>
<div class="paragraph">
<p>Once the pod has a dark blue ring around it, it is running, as per the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camelk-3.png" alt="Running Integration">
</div>
</div>
<div class="paragraph">
<p>If you haven&#8217;t already, click 'inside the circle' to open the overview window</p>
</div>
<div class="paragraph">
<p>Click on 'Resources'</p>
</div>
<div class="paragraph">
<p>Click on 'Pods &#8594; simple-xxxxxxxx' (xxxxxxx is randomly generated)</p>
</div>
<div class="paragraph">
<p>Click on 'Logs' to see the output from the integration, it should look similer to the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camelk-4.png" alt="Integration logs">
</div>
</div>
<div class="paragraph">
<p>The integration is a simple timer that triggers every 1 second and writes to the log file.</p>
</div>
<div class="paragraph">
<p>In the Terminal Browser window type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc get integrations</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should now see an integration called 'simple' in the list.</p>
</div>
<div class="paragraph">
<p>In the Terminal browser window type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"> oc describe integration simple</code></pre>
</div>
</div>
<div class="paragraph">
<p>You’ll see the “Integration” CRD definition that includes the integration defined as groovy code.</p>
</div>
<div class="paragraph">
<p>Let’s make a change to the integration</p>
</div>
<div class="paragraph">
<p>In the browser terminal window</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">vi examples/simple.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see the text - 'Hello Camel K from ${routeId}'</p>
</div>
<div class="paragraph">
<p>Change the text e.g. 'Hello Camel K from ${routeId}. Added some more text'</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To change the text, use the arrow gets to move to the text you want to change, press 'i', and type in the text. To save, press 'esc' and type ':wq' followed by 'enter'
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, you need to deploy this integration to Openshift again to test</p>
</div>
<div class="paragraph">
<p>Type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel run examples/simple.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are quick enough (you need to be really quick!), you’ll see the integration doing a rolling deployment</p>
</div>
<div class="paragraph">
<p>Look at the log file again (as above) to see if the change has been deployed</p>
</div>
</div>
<div class="sect2">
<h3 id="deploy-camel-k-in-developer-mode"><a class="anchor" href="#deploy-camel-k-in-developer-mode"></a>Deploy Camel K in Developer mode</h3>
<div class="paragraph">
<p><strong>While the process of redeploying is simple, it isn’t very developer friendly. The 'kamel' cli has a developer friendly “hot deploy” mode that makes this experience much better</strong></p>
</div>
<div class="paragraph">
<p>Let&#8217;s try it out :-</p>
</div>
<div class="paragraph">
<p>Delete the integration :-
There are 2 ways you can do this in the Terminal Browser window (your choice) :-</p>
</div>
<div class="paragraph">
<p>Use the “kamel” cli</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel delete simple</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or</p>
</div>
<div class="paragraph">
<p>Use the Openshift cli</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc delete integration simple</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is the great thing about CRDs, you can use the normal Openshift cli to managed the custom data model (integrations in this case)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Lets deploy the integration in developer mode, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel run examples/simple.groovy --dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see the deployment phases logged on the screen, followed by the log outputting automatically from the integration pod, useful for a developer to see what’s going on. The output should look similer to the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camelk-5.png" alt="Developer Mode">
</div>
</div>
<div class="paragraph">
<p>For the next exercise, you will need 2 terminal windows.</p>
</div>
<div class="paragraph">
<p>Copy the URL for the “browser terminal” and paste into a new browser tab</p>
</div>
<div class="paragraph">
<p>It should look something like :-
<a href="https://xxxxxxxxxxxxx/terminal/session/1" class="bare">https://xxxxxxxxxxxxx/terminal/session/1</a></p>
</div>
<div class="paragraph">
<p><strong>You will notice that the terminal window is also outputting the log, you need to create a new terminal session</strong></p>
</div>
<div class="paragraph">
<p>Change the url to a new session number e.g.
<a href="https://xxxxxxxxxxxxx/terminal/session/2" class="bare">https://xxxxxxxxxxxxx/terminal/session/2</a></p>
</div>
<div class="paragraph">
<p>In the new terminal, make sure you go back to the camel directory - if you followed the instructions, it will be called 'camel' (cd 'camel')</p>
</div>
<div class="paragraph">
<p>Make another change to the text in “simple.groovy” by following the same instructions above</p>
</div>
<div class="paragraph">
<p>Once you have saved the changes, go back to the browser terminal tab outputting the log.</p>
</div>
<div class="paragraph">
<p>You should see that the changes have been automatically applied to the running integration, without the need to redeploy</p>
</div>
<div class="paragraph">
<p><strong>That’s a much better way of round trip development of integrations…</strong></p>
</div>
<div class="paragraph">
<p>Go back to the browser terminal that’s outputting the log, press ‘ctrl c’</p>
</div>
<div class="paragraph">
<p>Look at the Topology view in the Openshift console(or oc get integrations)</p>
</div>
<div class="paragraph">
<p>The integration should have been deleted -</p>
</div>
<div class="paragraph">
<p><strong>Just like a developer would see by pressing 'ctrl c' on a Java application running on their laptop</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="optional-labs"><a class="anchor" href="#optional-labs"></a>Optional labs</h3>
<div class="paragraph">
<p>Feel free to take a look at some of the other examples</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Instructions on how to run the integrations are in the integration source code
E.g. ./kamel run --name=rest-with-restlet --dependency=camel-rest --dependency=camel-restlet examples/RestWithRestlet.java
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example above demonstrates Camel K deploying a Java based Camel Route that exposes a Restful service via an Openshift route - the Camel K operator does all the hard work for you</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
some of the examples might take a little longer to deploy as the operator will need to download more dependencies
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To test the rest api, you need to know what the Openshift Route is</p>
</div>
<div class="paragraph">
<p>In the Developer UI, go back to the Topology view, and click on “rest-with-restlet” application</p>
</div>
<div class="paragraph">
<p>Click on resources, and you will see the http route at the bottom of the page</p>
</div>
<div class="paragraph">
<p>Click on the http link</p>
</div>
<div class="paragraph">
<p>You will get an error as the integration will only response to /hello. Append ‘/hello’ to the URI
Now you should see a response</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="camel-k-and-openshift-serverless"><a class="anchor" href="#camel-k-and-openshift-serverless"></a>Camel K and Openshift Serverless</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction-4"><a class="anchor" href="#introduction-4"></a>Introduction</h3>
<div class="paragraph">
<p>Openshift Serverless, based on Knative is the serverless technology that was introduced in Openshift 4.2. Openshift Serverless enables Pods running on Openshift to be scaled to 0 therefore taking zero processing power. Only when called, Openshift Serverless will scale the Pod up on demand before processing the request. Openshift Serverless also has the ability to autoscale based on load before eventually scaling back to zero when no requests are being received.</p>
</div>
<div class="paragraph">
<p>Openshift Serverless supports "Serving" and "Eventing"</p>
</div>
<div class="paragraph">
<p>"Serving" enables request/response workloads, and Eventing enables asynchronous event based workloads using cloudevents. In this lab, we are going to look at eventing, and how easy it is to integration with Camel K.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-new-project-2"><a class="anchor" href="#create-a-new-project-2"></a>Create a new project</h3>
<div class="paragraph">
<p>In the browser based terminal window, create a new project called 'knative-userx' where 'x' is your allocated user number</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc new-project knative-userx</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="openshift-serverless-and-the-operator-lifecycle-manager"><a class="anchor" href="#openshift-serverless-and-the-operator-lifecycle-manager"></a>Openshift Serverless and the Operator Lifecycle Manager</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Openshift Serverless and the Operator Lifecycle Manager</div>
<div class="paragraph">
<p>Openshift Serverless uses the Operator Lifecycle manager, this means that its operator and Custom Resource Definitions (CRDs) will be added to Openshift via "OLM". Once created, the new CRDs will extend the Openshift data model allowing Openshift Serverless to be managed using the standard ‘oc’ command. Installing operators requires a higher cluster privilage so the presenter will demonstrate the installation of the operator shortly.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="install-openshift-serverless"><a class="anchor" href="#install-openshift-serverless"></a>Install Openshift Serverless</h3>
<div class="paragraph">
<p>The Openshift Serverless operator has to be installed by a higher level privilage. The presenter with demonstrate this to you shortly.</p>
</div>
<div class="paragraph">
<p><strong>'ADMIN only - Presenter demonstrates'</strong></p>
</div>
<div class="paragraph">
<p>Ensure that the Camel K operator is installed. Instructions can be found in the Camel K on Openshift lab guide.</p>
</div>
<div class="paragraph">
<p>Install Openshift Serverless:</p>
</div>
<div class="paragraph">
<p>If you are not already logged on go to the UI URL and login as 'opentlc-mgr' (Don’t forget to explain that this is a cluster admin function) and the admin password</p>
</div>
<div class="paragraph">
<p>Make sure you are on the 'Administration View' in the console</p>
</div>
<div class="paragraph">
<p>Go to 'Operators/Operator Hub'</p>
</div>
<div class="paragraph">
<p>Search for 'openshift serverless'</p>
</div>
<div class="paragraph">
<p>Install for all 'namespaces' in the cluster</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-1.png" alt="Serverless Operator Installation">
</div>
</div>
<div class="paragraph">
<p>Wait until 'Openshift Serverless' is shown as installed on the Operators/Installed Operators window</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When complete, Status will say 'InstallSucceeded'
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a new project called knative-serving</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure you create the knative-serving project as cluster admin (opentlc-mgr)
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc new-project knative-serving</code></pre>
</div>
</div>
<div class="paragraph">
<p>add Knative Serving custom resource definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc apply -f https://raw.githubusercontent.com/pprosser-redhat/devex-camelk/master/knative/serving.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Wait for Knative serving to be ready, you can check this by typing the following (This will take a few minutes)</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc get KnativeServing</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once Knative Serving is ready, it will look like the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-2.png" alt="Knative Serving Ready">
</div>
</div>
<div class="paragraph">
<p><strong>Now install Knative eventing</strong></p>
</div>
<div class="paragraph">
<p>Go to 'Operators/Operator Hub'</p>
</div>
<div class="paragraph">
<p>Search for 'knative eventing'</p>
</div>
<div class="paragraph">
<p>Click on 'Knative Eventing Operator'</p>
</div>
<div class="paragraph">
<p>Install for all 'namespaces' in the cluster as per the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-3.png" alt="Knative Eventing">
</div>
</div>
<div class="paragraph">
<p>Wait for the Operator to complete its installation</p>
</div>
<div class="paragraph">
<p><strong>'ADMIN only - finished'</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="download-and-configure-your-environment-2"><a class="anchor" href="#download-and-configure-your-environment-2"></a>Download and configure your environment</h3>
<div class="paragraph">
<p><strong>If you completed the 'Camel K' on Openshift lab then you do not need to follow this set of instructions. Move on to 'Create Knative Messaging Channel'</strong></p>
</div>
<div class="paragraph">
<p>Create a directory to download the examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">mkdir camel
cd camel</code></pre>
</div>
</div>
<div class="paragraph">
<p>Download the Camel K examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">wget https://github.com/pprosser-redhat/devex-camelk/raw/master/camelexamples/camel-k-examples-1.0.0-M4.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new directory for the examples</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">mkdir examples</code></pre>
</div>
</div>
<div class="paragraph">
<p>Uncompress the file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">tar -xf camel-k-examples-1.0.0-M4.tar.gz -C examples</code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow a developer to easily interact with an Openshift cluster, Camel K has it&#8217;s own command line interface. Download the 'Camel K cli' :-</p>
</div>
<div class="paragraph">
<p>In the same directory, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">wget https://github.com/pprosser-redhat/devex-camelk/raw/master/camelkcli/camel-k-client-1.0.0-M4-linux-64bit.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Uncompress the file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">tar -xf camel-k-client-1.0.0-M4-linux-64bit.tar.gz</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before we can create an integration, we need to add a Camel K 'IntegrationPlatform'.</p>
</div>
<div class="paragraph">
<p>In the terminal window, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc apply -f   https://raw.githubusercontent.com/pprosser-redhat/devex-camelk/master/camelkconfig/integrationplatform.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>You should now have all the pieces you need to start creating and deploying lightweight Camel Integrations to Openshift.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="create-knative-messaging-channel"><a class="anchor" href="#create-knative-messaging-channel"></a>Create Knative Messaging Channel</h3>
<div class="paragraph">
<p>By default, Knative uses an in memory messaging channel. In this lab we will configure 2 of these channels to use with Camel K</p>
</div>
<div class="paragraph">
<p>In the browser terminal window</p>
</div>
<div class="paragraph">
<p>Type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc apply -f examples/knative/messages-channel.yaml
oc apply -f examples/knative/words-channel.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure the channels have been created correctly</p>
</div>
<div class="paragraph">
<p>Type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">oc get InMemoryChannel</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see a screenshot like the one below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-4.png" alt="InMemory Channels Ready">
</div>
</div>
<div class="paragraph">
<p>You are looking for 'Ready' to be 'True'</p>
</div>
</div>
<div class="sect2">
<h3 id="deploy-the-integrations"><a class="anchor" href="#deploy-the-integrations"></a>Deploy the Integrations</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Introduction to the integrations that we will use</div>
<div class="paragraph">
<p>Now that we have deployed 2 message channels, we will deploy 3 Camel K Integrations. 'feed.groovy' will generate a simple sentence every 3 seconds, and send this to the 'message channel', 'splitter.groovy' will subscribe to the 'message channel', take the message, split the message into individual words before sending the individual words to 'words channel'. Finally, 'printer.groovy' will subscribe to the 'words.channel', read the words from the channel and print them to the output log.</p>
</div>
<div class="paragraph">
<p>The flow looks like :-</p>
</div>
<div class="paragraph">
<p>feed &#8594; message channel &#8594; spilter &#8594; words channel &#8594; printer</p>
</div>
</div>
</div>
<div class="paragraph">
<p>In the terminal window, deploy the 3 integrations</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel run examples/knative/feed.groovy
./kamel run examples/knative/splitter.groovy
./kamel run examples/knative/printer.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go to the developer view in the Openshift Console</p>
</div>
<div class="paragraph">
<p>Make sure you have chosen the project 'knative-user1'</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If this is the first time you&#8217;ve deployed a Camel K integration, it will take a few minutes to download the dependancies
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Until the 'splitter.grovy' integration deploys, expect to see errors from the 'feed.groovy' integration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once, all 3 of the Integrations are deployed, the topology view should look like the screnshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-5.png" alt="Integrations running">
</div>
</div>
<div class="paragraph">
<p>Each of the integrations is producing log information. To view the log for a running pod in the console</p>
</div>
<div class="paragraph">
<p>In the topology view,</p>
</div>
<div class="paragraph">
<p>Click inside the circle of an Integration to see the pop window, make sure the overview tab is selected. If should look like the screenshot below:-</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-6.png" alt="Viewing overview of running Integration">
</div>
</div>
<div class="paragraph">
<p>On the overview page, you will see a 'pod selector'.</p>
</div>
<div class="paragraph">
<p>'Click' on the pod selector</p>
</div>
<div class="paragraph">
<p>This will show you a screen like the one below:-</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-7.png" alt="Running Pod">
</div>
</div>
<div class="paragraph">
<p>'Click' on row entry under name e.g. splitter-zpsqt-deployment-77f946649-tfg5q in the screenshot above</p>
</div>
<div class="paragraph">
<p>This will show you the pod details screen like the one below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-8.png" alt="Pod Details">
</div>
</div>
<div class="paragraph">
<p>'Click' on 'Logs' to view the log for the pod. It should look something like the one below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-9.png" alt="Pod Details">
</div>
</div>
<div class="paragraph">
<p>Repeat the steps above for the other 3 Integrations.</p>
</div>
</div>
<div class="sect2">
<h3 id="knative-in-action"><a class="anchor" href="#knative-in-action"></a>Knative in action</h3>
<div class="paragraph">
<p>Make sure you are in the developer portal, looking at the Topology view before continuing</p>
</div>
<div class="paragraph">
<p>The 2 Integrations "hooked" into Knative Eventing are the 'spilter' and 'printer' integrations.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see if the promise of scale to zero works.</p>
</div>
<div class="paragraph">
<p>To stop the integrations, we need to stop messages arriving at the "messages.channel". To do this, we need to stop the feed integration.</p>
</div>
<div class="paragraph">
<p>Lets delete the 'feed.groovy' integration</p>
</div>
<div class="paragraph">
<p>In the terminal browser window, type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel delete feed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go back to the topology view, you will notice that the feed integration has gone.</p>
</div>
<div class="paragraph">
<p>Show some patience now, keep lookng at the topology view, we are waiting (and hoping!) that the integrations scale down to zero.</p>
</div>
<div class="paragraph">
<p>You will know when this starts as the rings around the circles will change from the normal blue to a very dark blue, before going white. Once they are white, the integrations are scaled to zero just like the screenshot below</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/camekknative-10.png" alt="Scaled to zero">
</div>
</div>
<div class="paragraph">
<p>To wake the Integrations up again, redeploy the 'feed' integration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">./kamel run examples/knative/feed.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go back to the topology view and you should see the 'feed' integration redeploy, and the 'spillter' and 'printer' integrations awake from their slumber!</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0<br>
Last updated 2020-01-10 13:55:08 UTC
</div>
</div>
</body>
</html>